
## 問題

### 入力
Grid: 10 <= L <= 50
Out: 60 <= N <= 100
Out cell: (Yi, Xi)

A = [A0, A1, ..., AN-1]
i番目のワームホールに入るとAi番目の出口セルに出る。
このAを推定する。

## 推定

### 配置

0 <= Pij <= 1000
コスト：上下左右の差の2乗の和

### 計測

- 0-10,000回
- (i, y, x)を指定
- i: ワームホール番号
- y, xはi番目の ワームホールに対応する出口セルから移動する距離
- コスト：100*(10+|y|+|x|)



## 考察

- 標準偏差Sがσの場合
    - -σ～+σが68%
    - -2σ～+2σが95%
- ワームホールを1つ選んで、その出口から(y, x)移動したときの温度を誤差付きで得る
- 出力mは0～1000の間で制限された値になる
    - Pはあまり0や1000近くを配置するとよく分からんかも
    - 500に近いほど制限されにくい
- S=900が最大で、このときはやばい
- 投票、多数決制みたいな感じで推定できないか？


区間推定（信頼区間）：https://blog.apar.jp/data-analysis/4632/


1. 500を中心に、0～1000までの温度を均等に選び、ワームホールの温度とする
2. ワームホール以外の温度はなだらかになるように初期値を決める
    - ワームホール以外は最初500に設定する（ワームホールは500以外に設定）
3. 山登りでコストが小さくなるように温度を更新（つらいので、一旦しない）
4. それぞれのワームホールの温度を複数回測定して、区間推定
    - (y, x)は(0, 0)
    - 候補が複数あるときに異なる出口セルまで移動して推定はありかも
5. 推定される温度範囲から出口の可能性のあるものを選択（区間推定の中心ほど評価値高いとする）




- 1点だけ温度を極高温にして、その他を極高温から-Sの温度にする
- 極高温への最短距離での到達方法は各出口からユニークになる
- この点は各出口からマンハッタン距離が最小になるように決めると良さそう
- 測定はマンハッタン距離が短い方から確認して、確定していった方が、距離が長い場合の測定回数が減る
- 誤差の影響で誤った結果を出してしまった場合、後の方で解が見つからない場合がある。その際は確定した場所を探索する


- 温度を0や1000によせると、平均化したときに温度が内側に偏ってしまうので、標準偏差が小さいときは真ん中に近い方が精度が良さそう
- 2σで95%の確率で分布するので、4σは離さない誤差がでる
- 標準偏差が大きくて、温度を0や1000にせざるを得ない場合は、0と1000が出たときに、補正をかけてあげた方が良さそう。もしくは、0と1000が出た数の多数決とか。

- 1点だけ温度を極高温にしているが、場面の大きさによっては、4分割とかした方が、測定時のコストを抑えられるかもしれない
    - y, xの設定が最大種類あって、ユニークに定まらないので、ダメ
    - 極高温と極低温の2分割だとユニークにできそう（分散が小さい場合はもっと分割できそうだけど、大きくなると2分割まで）



- ある温度範囲でランダムに温度を分布させる
- 各出口のマンハッタン距離1以下の温度パターンを求める
- 各ワームホールのマンハッタン距離1以下の温度パターンを測定する
- 温度パターンの類似度を求める。差分の合計が等しい場合は、差分の偏りが小さいのを優先
- 測定終了後、類似度の高いものから確定させていく


#### 試していないアイディア

-  2温度の測定回数は信頼区間から異なる方の温度が外れる回数とする


- 極高温を1つだけではなく、複数ポイントランダムに配置して、測定コスト(y, xの絶対値)を減らすことはできないか
    - これをやった場合、出口からの最短距離の(y, x)がユニークではなくなるので、注意が必要
    - ただし、2番目・3番目・・・に近い最短距離の組み合わせをしていけば、いつかユニークになる
        - 各出口から全ての極高温のポイントへの(y, x)情報を算出して、マンハッタン距離で昇順ソート
        - 各出口から最短距離の情報を抽出して、マンハッタン距離で昇順ソート
        - 近い箇所から順番に測定
            - マンハッタン距離が近い測定から順に行う（ただし、既に確定した情報はスキップ、複数あるので、カウント0でスキップ、全ての(y, x)で管理）
            - (y, x)がユニークであれば、確定
            - ユニークでなければ、2番目に近い(y, x)を抽出して、同じ作業を繰り返す
    - コスト
        - 極高温が増えた分だけ配置コストが増える
        - Lが大きいと、測定ポイントが増えることで(y, x)の種類が減るので、測定コストが減る
            - L=50のとき、測定ポイントが1つのとき、最大(y=25, x=25)で測定コストが6倍になるが、4つに増やすと、平均して、最大(y=6, x=6)ぐらいにできて2倍に抑えられる
        - 最短距離の(y, x)でダブりが多い場合は、その分次の短い距離を探索する分測定コストが増えるが、数が激減していると思うので、そんなに影響なさそう？




## 実験

- S=900のとき推定に必要な温度差と測定回数